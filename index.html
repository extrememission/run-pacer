<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Running Pace Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label, select, input, button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
        }
        .input-group {
            display: flex;
            gap: 10px;
        }
        .input-group input {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Advanced Running Pace Calculator</h1>
        <label for="calculationType">Calculation Type:</label>
        <select id="calculationType">
            <option value="timeToDistance">Calculate Time from Distance</option>
            <option value="distanceToTime">Calculate Distance from Time</option>
        </select>
        <label for="raceType">Race Type:</label>
        <select id="raceType">
            <option value="5k">5K</option>
            <option value="10k">10K</option>
            <option value="halfMarathon">Half Marathon</option>
            <option value="marathon">Marathon</option>
            <option value="custom">Custom</option>
        </select>
        <div id="customDistanceDiv" style="display:none;">
            <label for="customDistance">Custom Distance:</label>
            <div class="input-group">
                <input type="number" id="customDistance" step="0.01">
                <select id="customDistanceUnit">
                    <option value="km">km</option>
                    <option value="miles">miles</option>
                </select>
            </div>
        </div>
        <div id="timeInputs">
            <label>Time:</label>
            <div class="input-group">
                <input type="number" id="hours" min="0" placeholder="Hours">
                <input type="number" id="minutes" min="0" max="59" placeholder="Minutes">
                <input type="number" id="seconds" min="0" max="59" placeholder="Seconds">
            </div>
        </div>
        <div id="paceInputs" style="display:none;">
            <label>Pace:</label>
            <div class="input-group">
                <input type="number" id="paceMinutes" min="0" placeholder="Minutes">
                <input type="number" id="paceSeconds" min="0" max="59" placeholder="Seconds">
                <select id="paceUnit">
                    <option value="km">per km</option>
                    <option value="mile">per mile</option>
                </select>
            </div>
        </div>
        <label for="resultUnit">Result Unit:</label>
        <select id="resultUnit">
            <option value="km">km</option>
            <option value="mile">mile</option>
        </select>
        <button onclick="calculate()">Calculate</button>
        <div id="result"></div>
    </div>

    <script>
        function calculate() {
            const calculationType = document.getElementById('calculationType').value;
            const raceType = document.getElementById('raceType').value;
            const resultUnit = document.getElementById('resultUnit').value;

            let distance;
            if (raceType === 'custom') {
                distance = parseFloat(document.getElementById('customDistance').value);
                const distanceUnit = document.getElementById('customDistanceUnit').value;
                if (distanceUnit === 'miles') {
                    distance *= 1.60934; // Convert miles to km
                }
            } else {
                switch(raceType) {
                    case '5k': distance = 5; break;
                    case '10k': distance = 10; break;
                    case 'halfMarathon': distance = 21.0975; break;
                    case 'marathon': distance = 42.195; break;
                }
            }

            if (calculationType === 'timeToDistance') {
                const hours = parseInt(document.getElementById('hours').value) || 0;
                const minutes = parseInt(document.getElementById('minutes').value) || 0;
                const seconds = parseInt(document.getElementById('seconds').value) || 0;
                const totalSeconds = hours * 3600 + minutes * 60 + seconds;

                const pacePerKm = totalSeconds / distance;
                const paceMinutes = Math.floor(pacePerKm / 60);
                const paceSeconds = Math.round(pacePerKm % 60);

                let resultPace;
                if (resultUnit === 'km') {
                    resultPace = `${paceMinutes}:${paceSeconds.toString().padStart(2, '0')} per km`;
                } else {
                    const pacePerMile = pacePerKm * 1.60934;
                    const paceMinutesPerMile = Math.floor(pacePerMile / 60);
                    const paceSecondsPerMile = Math.round(pacePerMile % 60);
                    resultPace = `${paceMinutesPerMile}:${paceSecondsPerMile.toString().padStart(2, '0')} per mile`;
                }

                document.getElementById('result').textContent = `Your pace is ${resultPace}`;
            } else {
                const paceMinutes = parseInt(document.getElementById('paceMinutes').value) || 0;
                const paceSeconds = parseInt(document.getElementById('paceSeconds').value) || 0;
                const paceUnit = document.getElementById('paceUnit').value;

                let pacePerKm = paceMinutes * 60 + paceSeconds;
                if (paceUnit === 'mile') {
                    pacePerKm /= 1.60934; // Convert pace per mile to pace per km
                }

                const totalSeconds = pacePerKm * distance;
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = Math.round(totalSeconds % 60);

                document.getElementById('result').textContent = `Your time is ${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        document.getElementById('raceType').addEventListener('change', function() {
            const customDistanceDiv = document.getElementById('customDistanceDiv');
            customDistanceDiv.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        document.getElementById('calculationType').addEventListener('change', function() {
            const timeInputs = document.getElementById('timeInputs');
            const paceInputs = document.getElementById('paceInputs');
            if (this.value === 'timeToDistance') {
                timeInputs.style.display = 'block';
                paceInputs.style.display = 'none';
            } else {
                timeInputs.style.display = 'none';
                paceInputs.style.display = 'block';
            }
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
